(function(e){function t(t){for(var s,o,a=t[0],c=t[1],l=t[2],p=0,u=[];p<a.length;p++)o=a[p],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&u.push(i[o][0]),i[o]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);d&&d(t);while(u.length)u.shift()();return n.push.apply(n,l||[]),r()}function r(){for(var e,t=0;t<n.length;t++){for(var r=n[t],s=!0,a=1;a<r.length;a++){var c=r[a];0!==i[c]&&(s=!1)}s&&(n.splice(t--,1),e=o(o.s=r[0]))}return e}var s={},i={app:0},n=[];function o(t){if(s[t])return s[t].exports;var r=s[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=s,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(r,s,function(t){return e[t]}.bind(null,s));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var d=c;n.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},4676:function(e,t,r){"use strict";r("ed02")},"56d7":function(e,t,r){"use strict";r.r(t);var s=r("2b0e"),i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ecp-wrapper"},[t("div",{staticClass:"ecp-card"},[t("h2",[e._v("Цифровий підпис")]),t("iframe",{ref:e.id,attrs:{src:e.url},on:{load:function(t){e.loading=!1}}}),t("div",{staticClass:"ecp-btns"},[e.loaded?t("button",{on:{click:e.sign}},[e._v("Підписати")]):e._e(),t("button",[e._v("Відмінити")])])])])},n=[],o={data(){return{loading:!0,loaded:!1,s_debug:!1,sender:"EndUserSignWidgetConnector",reciever:"EndUserSignWidget",version:"20200922",parentId:"sign-widget-parent",id:"sign-widget",src:"https://eu.iit.com.ua/sign-widget/v20200922/",formType:0,formParams:null,iframe:null,m_promises:[],FormType:{ReadPKey:1,MakeNewCertificate:2,SignFile:3,ViewPKeyCertificates:4},SignAlgo:{DSTU4145WithGOST34311:1,RSAWithSHA:2,ECDSAWithSHA:3},SignType:{CAdES_BES:1,CAdES_T:4,CAdES_C:8,CAdES_X_Long:16}}},created(){this.formType=this.FormType.ReadPKey},mounted(){this.iframe=this.$refs[this.id],console.log(this.iframe),window.addEventListener("message",this.listener,!1),this.load()},computed:{url(){let e="?address="+this._parseURL(window.location.href).origin;if(e+="&formType="+this.formType,e+="&debug="+!1,this.formParams)for(let t in this.formParams)e+="&"+t+"="+this.formParams[t];return this.src+e}},methods:{listener(e){const t=this._parseURL(this.src).origin;e.origin===t&&this._recieveMessage(e)},load(){this.ReadPrivateKey().then(e=>{console.log(e),this.loaded=!0}).catch(e=>{console.log("Виникла помилка при зчитуванні особистого ключа: "+(e.message||e))})},sign(){const e=this.value instanceof Int8Array?this.value:JSON.stringify(this.value),t=null,r=!1,s=!0,i=this.SignAlgo.DSTU4145WithGOST34311,n=this.SignType.CAdES_X_Long;this.SignData(e,r,s,i,t,n).then(e=>{this.$emit("sign",e),this.show=!1}).catch(e=>{console.log("Виникла помилка при підписуванні даних: "+(e.message||e))})},_parseURL(e){const t=new RegExp(["^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?]*)"].join("")),r=e.match(t);return r&&{protocol:r[1],host:r[2],hostname:r[3],port:r[4],pathname:r[5],origin:r[1]+"//"+r[2]}},_postMessage(e,t,r,s){let i=null;const n={sender:this.sender,reciever:this.reciever,id:-1,cmd:e,params:t};"undefined"==typeof r&&"undefined"==typeof s?i=new Promise((e,t)=>{n.id=this.m_promises.push({resolve:e,reject:t,msg:n})}):n.id=this.m_promises.push({resolve:r,reject:s,msg:n});try{this.iframe.contentWindow.postMessage(n,this.src)}catch(o){this.s_debug&&console.log("Main page post message error: "+o)}return this.s_debug&&console.log("Main page post message: "+n),i},_recieveMessage(e){this.s_debug&&console.log("Main page recieve message: "+e.data);const t=e.data;if(t.reciever!==this.sender||t.sender!==this.reciever)return;if(-1===t.id){const e=this.m_promises;this.m_promises=[];for(let t=0;t<e.length;t++)this._postMessage(e[t].msg.cmd,e[t].msg.params,e[t].resolve,e[t].reject);return}const r=this.m_promises[t.id-1];r&&(delete this.m_promises[t.id-1],t.error?r.reject(t.error):r.resolve(t.result))},ReadPrivateKey(){const e=Array.prototype.slice.call(arguments);return this._postMessage("ReadPrivateKey",e)},SignData(e,t,r,s,i,n){const o=Array.prototype.slice.call(arguments);return this._postMessage("SignData",o)}}},a=o,c=(r("4676"),r("2877")),l=Object(c["a"])(a,i,n,!1,null,null,null),d=l.exports;new s["a"]({render:e=>e(d)}).$mount("#app")},ed02:function(e,t,r){}});
//# sourceMappingURL=app.8c7a3d37.js.map